<view class="container">
  <view class="user-info">
    <block wx:if="{{isLogin}}">
      <image 
        class="avatar" 
        src="{{userInfo.avatarUrl || '/static/images/default-avatar.png'}}" 
        mode="cover"
        bindtap="handleChangeAvatar"
      ></image>
      <text class="nickname">{{userInfo.nickName}}</text>
      <view class="user-actions">
        <button 
          class="action-btn" 
          hover-class="button-hover" 
          bindtap="showModifyPwdModal"
        >修改密码</button>
        <text class="action-divider">|</text>
        <button 
          class="action-btn" 
          hover-class="button-hover" 
          bindtap="handleLogout"
        >退出登录</button>
      </view>
    </block>
    <block wx:else>
      <image class="avatar" src="/static/images/default-avatar.png" mode="cover"></image>
      <button class="login-btn" bindtap="getUserProfile">点击登录</button>
    </block>
  </view>

  <view class="statistics">
    <view class="balance-card">
      <view class="balance-info">
        <text class="balance-label">账户余额</text>
        <text class="balance-value">¥{{balance}}</text>
      </view>
      <button class="withdraw-btn" bindtap="showWithdrawModal">提现</button>
    </view>
  </view>

  <!-- 添加提现记录显示 -->
  <view class="withdraw-history">
    <view class="history-title">提现记录</view>
    <view class="history-list">
      <block wx:if="{{withdrawRecords.length > 0}}">
        <view class="history-item" wx:for="{{withdrawRecords}}" wx:key="index">
          <view class="history-info">
            <view class="history-time">{{item.date}} {{item.time}}</view>
            <view class="history-balance">余额: ¥{{item.afterBalance}}</view>
          </view>
          <view class="history-amount">-¥{{item.amount}}</view>
        </view>
      </block>
      <view class="no-history" wx:else>暂无提现记录</view>
    </view>
  </view>

  <view class="menu-list">
    <!-- 其他菜单项 -->
  </view>

  <view class="version">
    <text>版本号：1.0.0</text>
  </view>

  <!-- 登录弹窗 -->
  <view class="modal" wx:if="{{showLoginModal}}" bindtap="handleModalTap">
    <view class="modal-content" catchtap="handleContentTap">
      <view class="modal-header">
        <text class="modal-title">账号登录</text>
      </view>
      <view class="modal-body">
        <input 
          class="pwd-input"
          type="text" 
          placeholder="请输入账号" 
          value="{{username}}"
          bindinput="onUsernameInput"
        />
        <input 
          class="pwd-input"
          type="password" 
          placeholder="请输入密码" 
          value="{{password}}"
          bindinput="onPasswordInput"
        />
      </view>
      <view class="modal-footer">
        <button class="btn cancel" bindtap="hideLoginModal">取消</button>
        <button class="btn confirm" bindtap="handleLogin">登录</button>
      </view>
    </view>
  </view>

  <!-- 修改密码弹窗 -->
  <view class="modal" wx:if="{{showPwdModal}}" catchtap="hideModifyPwdModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">修改密码</text>
      </view>
      <view class="modal-body">
        <input type="password" 
               class="pwd-input" 
               placeholder="请输入原密码" 
               value="{{oldPassword}}"
               bindinput="onOldPwdInput"/>
        <input type="password" 
               class="pwd-input" 
               placeholder="请输入新密码" 
               value="{{newPassword}}"
               bindinput="onNewPwdInput"/>
        <input type="password" 
               class="pwd-input" 
               placeholder="请确认新密码" 
               value="{{confirmPassword}}"
               bindinput="onConfirmPwdInput"/>
      </view>
      <view class="modal-footer">
        <button class="btn cancel" bindtap="hideModifyPwdModal">取消</button>
        <button class="btn confirm" bindtap="handleModifyPwd">确认</button>
      </view>
    </view>
  </view>

  <!-- 提现弹窗 -->
  <view class="modal" wx:if="{{showWithdrawModal}}" bindtap="handleWithdrawModalTap">
    <view class="modal-content" catchtap="handleContentTap">
      <view class="modal-header">
        <text class="modal-title">提现</text>
      </view>
      <view class="modal-body">
        <input 
          type="digit" 
          class="pwd-input"
          placeholder="请输入提现金额" 
          value="{{withdrawAmount}}"
          bindinput="onWithdrawAmountInput"
        />
      </view>
      <view class="modal-footer">
        <button class="btn cancel" bindtap="hideWithdrawModal">取消</button>
        <button class="btn confirm" bindtap="handleWithdraw">确认提现</button>
      </view>
    </view>
  </view>

  <!-- 提现记录弹窗 -->
  <view class="modal" wx:if="{{showRecordsModal}}" bindtap="handleRecordsModalTap">
    <view class="modal-content records-content" catchtap="handleContentTap">
      <view class="modal-header">
        <text class="modal-title">提现记录</text>
      </view>
      <view class="modal-body">
        <view class="withdraw-records">
          <block wx:if="{{withdrawRecords.length > 0}}">
            <view class="record-item" wx:for="{{withdrawRecords}}" wx:key="index">
              <view class="record-info">
                <view class="record-time">{{item.date}} {{item.time}}</view>
                <view class="record-balance">余额: ¥{{item.afterBalance}}</view>
              </view>
              <view class="record-amount">-¥{{item.amount}}</view>
            </view>
          </block>
          <view class="no-records" wx:else>暂无提现记录</view>
        </view>
      </view>
      <view class="modal-footer">
        <button class="btn confirm" bindtap="hideRecordsModal">关闭</button>
      </view>
    </view>
  </view>
</view> 